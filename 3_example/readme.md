存储的持续性、作用域、链接性

1. 存储的持续性

   - 自动存储持续性：

     在函数定义中声明的变量（包含函数参数）的存储持续性为自动的。它们在程序开始执行其所属的函数或代码块时被创建，在执行完函数或者代码块时，它们使用的内存被释放。

   - 
     静态存储持续性：

     在函数定义外定义的变量和使用关键字static定义的变量的存储持续性都是静态的，它们在程序整个运行过程中都存在

   - 线程存储持续性：

     这能让程序能够将计算放在可并行处理的不同线程中，如果变量时使用关键在thread_local声明的，则其生命周期与所属的线程一样长；

   - 动态存储持续性：

     用new运算符分配的内存将一直存在，知道使用delete运算符将其释放或程序结束为止，这种内存的存储持续性为动态的，有事被称为自由存储（free store）或堆（heap）。

2. 静态持续变量：

   C++为静态存储持续性变量提供了3种链接性：外部链接性、内部链接性、无链接性

   - 外部链接性：可在其他文件中访问
   - 内部链接性：只能在当前文件中访问
   - 无链接性：只能在当前函数或代码块中访问。

   这三种链接性都在整个程序执行期间存在，与自动变量相比，它们的寿命更长。由于静态变量的数目在程序运行期间时不变的，因此程序不需要使用特殊的装置（如栈）来管理它们，编译器将分配固定的内存块来存储所有的静态变量，如果没有显式的初始化变量，编译器将把他设置为0。在默认情况下，静态数组和结构将每个元素或成员的所有位设置为0。

   ```c++
   int global = 1000;		//静态变量，外链接性
   static int one_file = 50; 	//静态变量，内部链接性
   int main()
   {
       static int i = 10;		//静态变量,无链接性
   }
   
   ```

   ![Snipaste_2019-10-06_10-21-37](/home/zzz/z_personal/CCC-/0_image/Snipaste_2019-10-06_10-21-37.png)

3. const 与extern 

   const常量一般可以直接放在头文件中

   const声明的全局变量的链接性为内部链接性，下面两句是等效的。

   ```c++
   const int fingers = 10;		
   static const int fingers =10;
   
   // 可用一下定义为外部链接性的常量；
   extern const int fingers =10;
   ```

4. 函数和链接性

   C++不允许在一个函数中定义另一个函数，所有函数的存储持续性都为静态的，在整个程序运行期间一直存在。

   在默认情况下，函数的链接性时外部的，即可以在文件间共享。可以在函数原型中使用关键字extern来指出函数实在另一个文件中定义的，还可以使用static讲函数的链接性设置为内部的，使之只能在一个文件中使用。

   ```c++
   static int function(double x);
   static int function(double x)
   {
       ...
   }
   ```

   